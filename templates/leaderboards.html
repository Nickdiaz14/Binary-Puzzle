<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=0.9, user-scale=no, maximum-scale=0.9">
        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/styles.css') }}">
        <title>Leaderboards</title>
    </head>
    <body>
        <div style="text-align:center; margin: 20px;">
            <span id="title" style="font-size: 26px; font-weight: bold; color: #ffffff;">top 5 de </span>
            <select id="matrix-size" style="padding: 1px; font-size: 26px; font-weight: bold; border-radius: 8px; border: 2px solid #ffffff; background-color: #190e30; color: #ffffff; cursor: pointer; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);" onchange="reset()">
                <option value="4" selected>4 x 4</option>
                <option value="6">6 x 6</option>
                <option value="8">8 x 8</option>
                <option value="10">10 x 10</option>
                <option value="Contrareloj">Contrareloj</option>
            </select>
        </div>
        <div id="leaderboard" style="text-align: center;margin-top: 20px;"></div>
        <button onclick="location.href=`/menu?userID=${localStorage.getItem('userId')}`" class="resolver azulito" style="margin-top: 20px;text-align: center; width: 150px; height: 50px; font-size: 18px;">Volver</button>
        <script>
            // Obtener los datos del leaderboard pasado desde el backend
            const data = JSON.parse('{{ data | safe }}');

            function reset() {
                let leaderboardDiv = document.getElementById('leaderboard');
                leaderboardDiv.innerHTML = '';
                let table = document.createElement('table');
                let n = document.getElementById('matrix-size').value;
                let leaderboardData = data[`T${n}`];

                // Crear encabezados de la tabla
                table.innerHTML = `
                    <tr>
                        <th>Posici칩n</th>
                        <th>Nombre</th>
                        <th>Record</th>
                    </tr>
                `;
        
                // Mostrar las entradas del leaderboard
                leaderboardData.slice(0, 5).forEach((entry, index) => {
                    let row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="tipo2">${index + 1}</td>
                        <td class="tipo2">${entry[0]}</td>
                        <td class="tipo2">${entry[1]}</td>
                    `;
                    table.appendChild(row);
                });
        
                leaderboardDiv.appendChild(table);

                const userIndex = leaderboardData.findIndex(entry => entry[2] === localStorage.getItem('userId'));

                if (userIndex !== -1 && userIndex >= 5) { // Si el usuario est치 en la lista
                    // Espacio entre tabla y nueva secci칩n
                    let space = document.createElement('div');
                    space.style.marginTop = "30px";
                    leaderboardDiv.appendChild(space);

                    // Crear una nueva fila con tres celdas separadas
                    let extraTable = document.createElement('table');
                    extraTable.style.width = table.offsetWidth + 'px'
            
                    // Crear encabezados de la tabla
                    extraTable.innerHTML = `
                        <tr>
                            <th>Posici칩n</th>
                            <th>Nombre</th>
                            <th>Record</th>
                        </tr>
                    `;
                    let extraRow = document.createElement('tr');
                    extraRow.innerHTML = `
                        <td class="tipo2">${userIndex + 1}</td>
                        <td class="tipo2">${leaderboardData[userIndex][0]}</td>
                        <td class="tipo2">${leaderboardData[userIndex][1]}</td>
                    `;
                    extraTable.appendChild(extraRow);
                    leaderboardDiv.appendChild(extraTable);
                }
            }
            reset();
        </script>
    </body>
    </html>